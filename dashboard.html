<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript" src="https://dl.frontapp.com/libs/plugin-sdk-1.8.1.min.js"></script>
    <style>
        body { margin: 0; padding: 0; overflow: hidden; }
        iframe { border: none; width: 100%; height: 100vh; }
        #content { height: 100vh; display: flex; align-items: center; justify-content: center; }
        .message { padding: 20px; text-align: center; color: #666; }
    </style>
</head>
<body>
    <div id="content"><div class="message">Loading...</div></div>
    
    <script>
        Front.contextUpdates.subscribe(context => {
            if (context.type === 'singleConversation') {
                const conversation = context.conversation;
                
                // Look for "Dashboard View" link
                const dashboardLink = conversation.links?.find(link => 
                    link.name === 'Dashboard View'
                );
                
                if (dashboardLink && dashboardLink.externalUrl) {
                    document.getElementById('content').innerHTML = 
                        `<iframe src="${dashboardLink.externalUrl}"></iframe>`;
                } else {
                    document.getElementById('content').innerHTML = 
                        `<div class="message"><p>No dashboard available</p></div>`;
                }
            } else {
                document.getElementById('content').innerHTML = 
                    `<div class="message"><p>Select a conversation</p></div>`;
            }
        });
    </script>
</body>
</html>
